---
title: "Time Series Analysis - Day 1"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

### Packages and libraries installation.

```{r}
#install.packages('forecast', dependencies = TRUE)
library(forecast)
library(ggplot2)
```

Forecast gives usefull tools for time series analysis.

### Exercise 1 : Time series "Varicelle" analysis.

```{r}
data=read.csv(file="http://eric.univ-lyon2.fr/~jjacques/Download/DataSet/varicelle.csv")
plot(data$x)
varicelle<-ts(data$x,start=c(1931,1),end=c(1972,6),freq=12)
plot(varicelle)
```

We observe a cyclic pattern.

```{r}
mean(varicelle)
```

```{r}
tmp=acf(varicelle, type="cor", plot=TRUE)
ptmp=pacf(varicelle, type="cor", plot=FALSE)
plot (ptmp)
```

The correlogram shows that the data are cyclic. We can see a correlation close to 1 every lag=1 so data looks correlated from one year to the next one.

```{r}
ggseasonplot(varicelle,year.labels= TRUE,year.labels.left=TRUE)
```

The seasonal plot confirm this trend, we can see that every year we have an increase on spring and a decrease on summer.

Let's print the graph year by year instead of month by month.

```{r}
plot(aggregate(varicelle,nfrequency=1))
```

We dont see now a cyclic pattern. However we can see trends corresponding to historical events, like the dramatic decrease during the 2nd world war (due to the decrease of the natality).

### Exercise 2 : Forcasting CO2 concentration

Plot data from R library dataset CO2.

```{r}
plot(co2)
data1=co2
```

Which exponential smoothing model is appropriate ?
Let's try some.
As the data are seasonal increasing, we'll not use the non seasonal model.

1.  Separate training and test data

    ```{r}
test_data=window(co2,start=c(1959,1),end=c(1989,12))
train_data=window(co2,start=c(1990,1),end=c(1997,12))
CO2_train<-ts(train_data,start=c(1959,1),end=c(1989,12),freq=12)
CO2_test<-ts(test_data,start=c(1990,1),end=c(1997,12),freq=12)
    ```

2. Additive seasonal Holt-winters

```{r}
h=hw(co2_train,seasonal='additive',damped=FALSE,h=96)
h_add=hw(co2_train,seasonal='additive',damped=TRUE,h=96)
plot(CO2_train,xlim=c(1989,1991),ylim=c(350,360))
p<-predict(h,n.ahead=84)
p2<-predict(h_add,n.ahead=84)
lines(p,col="red")
lines(p2,col="blue")
```

